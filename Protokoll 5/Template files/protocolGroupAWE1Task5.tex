\documentclass{ifacconf}

\usepackage{natbib}            % you should have natbib.sty
\usepackage[utf8]{inputenc}    % Eingabe von Umlauten im Editor, dieser sollte dann auch auf utf8 Encoding eingestellt sein
\usepackage{graphicx}          % Include this line if your 
                               % document contains figures,
%\usepackage[dvips]{epsfig}    % or this line, depending on which
                               % you prefer.
                               
\usepackage{units}

% for German
% \usepackage{ngerman}           % neue Deutsche Rechtschreibung, Silbentrennung
% \usepackage[T1]{fontenc}       % Trennung mit Umlauten

% to include tikz pictures of figure created with matlab2tikz, see also file ``plotFigureTest.m''
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=newest}  % use newest version of pgfplots
\usepackage{amsmath}  % useful for math

% to include the legend into the caption. The commands are
%\mlLineLegend{red}
%\mlLineLegendDashed{red}
%\mlLineLegendDotted{red}
%\mlLineLegendDashDotted{red}
%\mlPointLegend{red}
\newlength{\mlLegendThickness}
\setlength{\mlLegendThickness}{0.4mm}
\newlength{\mlLegendHeight}
\setlength{\mlLegendHeight}{0.6ex}
\newcommand{\mlLineLegend}[1]{\mbox{\color{#1}
\protect\rule[\mlLegendHeight]{3mm}{\mlLegendThickness}\hspace*{-1mm}
}}
\newcommand{\mlLineLegendDashed}[1]{\mbox{\color{#1}
\protect\rule[\mlLegendHeight]{1.5mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{1.5mm}{\mlLegendThickness}\hspace*{-1mm}
}}
\newcommand{\mlLineLegendDotted}[1]{\mbox{\color{#1}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{-1mm}
}}
\newcommand{\mlLineLegendDashDotted}[1]{\mbox{\color{#1}
\protect\rule[\mlLegendHeight]{1.5mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{1.5mm}{\mlLegendThickness}\hspace*{0mm}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{-1mm}
}}
\newcommand{\mlPointLegend}[1]{\mbox{\color{#1}
\protect\rule[\mlLegendHeight]{0.4mm}{\mlLegendThickness}\hspace*{-0.75mm}
}}

\begin{document}

\begin{frontmatter}

\title{KRT Praktikum: Protokoll 5 - Abschlussprotokoll}

\thanks[footnoteinfo]{Institute for Systems Theory and Automatic Control, University of Stuttgart, Germany. \textit{http://www.ist.uni-stuttgart.de}}

% include all authors, underline corresponding author
\author{Kimon Beyer, Yves Gaßmann, Justin Buhl} 
% \author{}

\begin{abstract}        

% Abstract of not more than 250 words.
\end{abstract}

\end{frontmatter}

\section{Einleitung}
In diesem Protokoll werden die Ergebnisse des Praktikums "Konzepte der Regelungstechnik" am Institut für Systemtheorie und Regelungstechnik der Universität Stuttgart zusammengefasst. Ziel des Praktikums ist es, die Konzepte der Regelungstechnik anhand eines 3DOF Helikopters zu verstehen und anzuwenden. Das Praktikum besteht aus mehreren Laboraufgaben (L1, L2, L3, L4, L5) und Hausaufgaben (H1, H2, H3, H4, H5), die sich mit der Inbetriebnahme, Modellierung, Reglerentwurf und Trajektoriengenerierung beschäftigen. Die Implementierung der Regler und die Trajektoriengenerierung erfolgen mittels MATLAB/Simulink und dem Echtzeitsystem QUARC, welches die Implementierung am Realen System ermöglich. Der für diese Aufgabenstellung verwendete Versuchsstand ist ein 3DOF Helikopter, der entlang seiner Hauptachsen/Gelenkachsen (Schwenkwinkel $\alpha$, Steigwinkel $\beta$, Nickwinkel $\gamma$) bewegt werden kann. Die Bewegung um die Achsen wird von zwei Elektormotoren ermöglicht, welche die beiden Propeller des Helikopters antreiben (vgl. Abbildung \ref{fig:helikopter}). 

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\columnwidth]{Helikopter.pdf}
    \caption{Versuchsstand: 3DOF-Helikopter. Besteht aus Haupt- und Nebenarm, sowie Gegengewicht 
    und am Ende des Arms befindlichen Helikopter.}
    \label{fig:helikopter}
\end{figure}

Diese können direkt die Steig- und Nickwinkel beeinflussen, während der Schwenkwinkel indirekt durch den Nickwinkel beeinflusst wird. Ziel des Praktikums ist es, ein vorgegebenes Szenario, wie es in Abbildung \ref{fig:mainTask} zu erkennenist, innerhalb einer gewissen Zeit (180s) abzufliegen und dabei die jeweiligen Beschränkungen einzuhalten. Die Höhenbeschränkung von mindestens -7.5° bezieht sich hierbei auf den Steigwinkel, welcher während des Schwenken zwischen Positionen eingehalten werden muss. Außerdem muss während der Landung und dem Aufstieg ein Schwenkwinkel von maximal ±7.5° relativ zu der Landeposition eingehalten werden, um eine Kollision mit Hindernissen zu vermeiden.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\columnwidth]{mainTask.png}
    \caption{Hauptaufgabe der Lehrveranstaltung: Frachttransport eines Magneten}
    \label{fig:mainTask}
\end{figure}





\section{Modellierung}

\section{Reglerentwurf}

\section{Trajektoriengenerierung}
\subsection{Diskret (D)}
Nach der Modellierung und dem Reglerentwurf erfolgt im Folgenden Kapitel die Trajektoriengenerierung, welche die Führungsgröße für die vorherige gewonnene Reglerstruktur vorgibt. Dabei soll die Trajektorie so gestaltet sein, dass die Bewegung des Helikopters möglichst sanft erfolgt und keine plötzlichen Sprünge in den Sollwerten auftreten.
Dies ist wichtig, da der Regler aus Erfahrungen des dritten Labortages nur begrenzt in der Lage ist, schnelle Änderungen der Sollwerte zu verfolgen, ohne dass es zu Überschwingern oder Instabilitäten kommt.

Zum erstellen der Trajektorie wird in Matlab die Funktion \texttt{interp1} verwendet. Diese Funktion ermöglicht es durch die Interpolation einer Reihe von manuell bestimmten Stützpunkten, eine Trajektorie zu generieren.
Hierbei ist zu erwähnen, dass für die Travel und Elevation Trajektorie wie in Abbildung \ref{fig:Travel_Trajektorie} und \ref{fig:Elevation_Trajektorie} zu sehen ist \texttt{pchip} als Interpolationsmethode gewählt wurde. Diese ist eine formbewahrende kubische Interpolation, welche eine langsame Annäherung ohne Überschwingen gewährleistet.

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.9\columnwidth]{Travel_Trajektorie.png}
    \caption{Travel Trajektorie}
    \label{fig:Travel_Trajektorie}
\end{figure}

\begin{figure}[htpb]
    \centering
    \includegraphics[width=0.9\columnwidth]{Elevation_Trajektorie.png}
    \caption{Elevation Trajektorie}
    \label{fig:Elevation_Trajektorie}
\end{figure}

Es ist ebenfalls wichtig, dass die vorgegebene Trajektorie innerhalb der physikalischen Grenze des Helikopters bleibt.
Dies fließt in die Wahl der Stützpunkte mit ein, da unter anderem der Gradient der Trajektorie während dem Landeanflug größer sein darf, als während dem Aufstieg.
In Abbildung \ref{fig:Gradient} ist die resultierende Geschwindigkeit der Elevation- und Travel Trajektorie dargestellt, anhand welcher die Einhaltung der physikalischen Grenzen überprüft werden kann.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\columnwidth]{Gradient.png}
    \caption{Gradient der Trajektorien}
    \label{fig:Gradient}
\end{figure}

Daran ist zu erkennen, dass der Helikopter sich nie in einem Bereich bewegt, welcher für ihn nicht realisierbar ist.
Es ist auch möglich die Bewegungen in Travel und Elevation näher aneinander zu Reihen, um die Gesamtdauer der Trajektorie zu verkürzen. Hierbei ist allerdings darauf zu achten, dass die minimale Höhe des Helikopters nicht unterschritten wird.
Eine Trajektorie für den pitch wurde nicht erstellt, da dieser während des gesamten Fluges nahe null bleiben soll und somit durch eine Konstante dargestellt werden kann.
Die so erstellten Trajektorien werden im Folgenden in \texttt{.mat} Dateien gespeichert und als LookUp Table in Matlab Simulink eingebunden.


\subsection{Optimalsteuerung (OSP)}
Eine weitere Methode zur Trajektoriengenerierung ist die Optimalsteuerung, welche auf der Lösung eines Optimierungsproblems basiert. Hierbei wird eine Kostenfunktion definiert, welche die Abweichung von der gewünschten Trajektorie sowie die maximal verfügbaren Steuerungsgrößen berücksichtigt. 
Im Folgenden wird diese mit Hilfe \texttt{CasADi} implementiert.

\subsection{Magnetsteuerung}
Für die beiden vorherigen Methoden der Trajektoriengenerierung, wird die Magnetsteuerung nicht berücksichtigt. Aufgrund dessen wird hier eine weitere Methode verwendet, die durch die Verwendung eines Stateflow Diagramms in Simulink die Steuerung des Magneten ermöglicht. Hierbei ist es möglich, verschiedene Zustände wie "Magnet an" und "Magnet aus" zu definieren und die Übergänge zwischen diesen Zuständen basierend auf bestimmten Bedingungen zu steuern. 
Der Magnet wird dabei wie in Abb.\ref{fig:Magnet_Stateflow} von Anfang an aktiviert und wird erst am Ende des zweiten Landeanfluges, sobald die Höhe des Helikopters unter einem bestimmten Schwellenwert liegt, deaktiviert.  

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\columnwidth]{Magnet_Stateflow.png}
    \caption{Magnet Stateflow Diagram}
    \label{fig:Magnet_Stateflow}
\end{figure}






\section{Ergebnisse}

Die Validierung der Trajektorien erfolgt durch einen Vergleich der Soll- und Ist-Werte während der Simulation im Simulink. Hierbei wird überprüft, ob die Trajektorien die gewünschten Eigenschaften aufweisen und die physikalischen Grenzen des Helikopters eingehalten werden.
Dabei hat sich ergeben, dass der Helikopter der Trajektorie folgt und dabei die aus der Aufgabenstellungen gegebenen Grenzen einhält.
Es hat sich jedoch heraus gestellt, dass der Helikopter der Trajektorie nur träge folgt. In Abbildung \ref{fig:Referenzwertfolge} ist zu erkennen,
dass der Helikopter die Referenzwerte der Trajektorie nur verzögert verfolgt. Daher ergab sich die Überlegung für die Entwicklung einer 
Vorsteuerung.

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.9\columnwidth]{referenzwertfolge_verzoegerung.jpg}
    \caption{Verzögerung der Referenzwertfolge}
    \label{fig:Referenzwertfolge}
\end{figure}

Des Weiteren hat sich heraus gestellt, dass noch eine Anpassung der Gewichtungsmatrizen der LQI Reglersynthese vorgenommen werden kann, 
um ein besseres Führungsverhalten des Helikopters zu erreichen. Nach iterativem Tuning der Gewichtungsmatrizen 
konnte eine zufriedenstellende Performance der Regelung und Trajektorienfolge erzielt werden, wodurch der Helikopter 
die Geforderte Aufgabe, mit Magnet, in ungefähr 70 Sekunden absolviert. Dennoch stellt das Hinterherhinken der Trajektorie
ein Problem dar, das adressiert werden muss, um eine optimale Lösung zu erzielen. 




\section{Schlussfolgerungen und Fazit}


\end{document}